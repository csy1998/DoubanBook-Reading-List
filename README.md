# DoubanBook Reading List
java课程大作业，豆瓣读书预览器

项目名称：网络爬虫之豆瓣书籍
项目简介：从豆瓣网站中的豆瓣读书网页中例如小说、散文、童话等所有热门标签出发，爬取各个标签下的书籍信息，包括书名、作者、豆瓣评分、出版社、价格、、封面图片、作者简介以及内容简介等。将爬取到的书籍信息保存在本地，再设计界面将书籍信息重新整理生成呈现出来，并实现一定功能，例如豆瓣网页中未实现的按豆瓣评筛选。

项目由来：豆瓣可以对电影进行按评分排序，但是对书籍只能按评价排序，不能想电影一样通过网友评分进行筛选，有时候会感到不方便。我们希望实现对豆瓣书籍的评分筛选功能，例如筛选出评分>=9.0的书籍等。

##### 功能实现：
* 爬虫自动爬取豆瓣书籍，所需数量可以自定
* 爬取豆瓣书籍信息（包括 书名|评分|作者|出版社|价格|封面图片|作品简介|作者简介）
* 界面化显示所有书籍信息
* 界面显示方式：网格模式|列表模式
* 网格模式下点击书籍可以显示书籍具体简介
* 列表模式下可以直接查看所有信息，点击封面图片可以显示作品封面原图大图
* 按豆瓣评分筛选书籍
* 按作者/书名搜索书籍 
* 上一页|下一页|首页|尾页|跳转页面功能

#### 程序框架：
主要分两部分：爬虫部分 + 界面功能部分

##### 爬虫部分 ：
1. 从豆瓣读书的热门标签网页出发，先解析网页源代码用正则匹配取得所有标签网址，将网址中的中文进行转码并保存；
2. 爬虫自动依次解析每一个标签网址的网页源代码，正则匹配后取得标签页下所有书籍网址，并保存得到所有书籍网址；
3. 爬虫自动依次解析每一个书籍网址，正则匹配后取得书籍网页下所有书籍信息，并通过序列化保存得到本地；

##### 界面功能部分：
1. 列表模式：界面每行显示一本书籍的所有信息，点击封面可以查看原图（尺寸为原图的尺寸）；
2. 网格模式：界面每行显示五本书籍信息（封面|书名|豆瓣评分），点击封面可以显示对应书籍的所有信息；
3. 搜索书籍：输入要搜索的书名或作者，点击搜索得到搜素结果；
4. 评分筛选：选择想要筛选的评分段（分7档：全部|>=9.5|>=9.0|>=8.5|>=8.0|>=7.5|>=7.0）；
5. 跳转页面：可以进行上下翻页、跳转页面到首尾页以及跳转到指定页；
6. 实时显示当前页号以及得到的书籍数量；

#### 程序说明：
##### 代码概述：
* Book.java：书籍类，包括一本书的书名评分价格等具体信息；
* ImageButton.java：显示书籍封面，并实现点按得到具体信息或大图；
* Crawl.java：主程序，包含爬虫程序以及界面功能实现程序；

##### 运行：
* 先运行getBookInfo()函数自动爬取书籍信息并保存到本地（保存序列化对象以及txt文件）；
* 再注释getBookInfo()运行
```
Crawl crawl = new Crawl();
crawl.init();
crawl.start();
```
#### 遇到的问题及应对方案：
* 问题：豆瓣网站反爬虫比较厉害，爬虫运行时，如果爬取速度太快被封IP，只能等15分钟，豆瓣解封IP后才能重新爬取，严重时会直接连浏览器都无法访问豆瓣；
  方案：模拟人工浏览网页的速度来爬取（每爬取一定数量的书籍就sleep一会），速度虽然慢，但是能够不被封IP地爬取到所需信息；
* 问题：每次运行程序要先爬取信息才能界面化呈现，重复爬取书籍会比较浪费时间；
  方案：先一次爬取所需的所有书籍信息，序列化保存书籍对象到本地，界面化呈现的时候先从本地加载，反序列化恢复书籍对象信息，再做界面；
* 问题：界面显示时载入大量书籍会导致虚拟机内存溢出；
  方案：载入书籍数量少一些或者编译时手动增加虚拟机内存

#### 存在的一些问题：
* 爬取书籍数量不够大（大概爬了3000本）：爬取书籍有时间间隔（sleep），总体耗时比较长，不知道是不是电脑的问题，连上的校园网偶尔会断，导致每次只能从头开始运行爬虫；
* 书籍封面图片体积较大，1000本书的图片大小差不多快100M，载入书籍数太大的话，光是封面图片的载入就可能使得虚拟机内存溢出，界面切换视图的时候渲染也比较慢。测试后发现载入500本的时候比较流畅的，载入800本时渲染比较慢，载入1000本及以上则会出现内存不够的问题，所以程序在演示时载入500本；
* 列表模式的UI可以设计得更加美观，但是由于个人时间精力有限，暂未对这部分进行优化；
